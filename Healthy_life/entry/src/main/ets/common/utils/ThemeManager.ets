/**
 * ä¸»é¢˜ç®¡ç†å™¨
 * æä¾›5ç§é¢„è®¾ä¸»é¢˜
 */

export interface ThemeConfig {
  name: string;
  primaryColor: string;
  secondaryColor: string;
  backgroundColor: string;
  textColor: string;
  icon: string;
}

/**
 * é¢„è®¾ä¸»é¢˜åˆ—è¡¨
 */
export const THEMES: ThemeConfig[] = [
  {
    name: 'å¥åº·ç»¿',
    primaryColor: '#4CAF50',
    secondaryColor: '#81C784',
    backgroundColor: '#E8F5E9',
    textColor: '#1B5E20',
    icon: 'ğŸŒ¿'
  },
  {
    name: 'æ´»åŠ›æ©™',
    primaryColor: '#FF6B35',
    secondaryColor: '#FF8C61',
    backgroundColor: '#FFF3E0',
    textColor: '#E65100',
    icon: 'ğŸ”¥'
  },
  {
    name: 'å®é™è“',
    primaryColor: '#2196F3',
    secondaryColor: '#64B5F6',
    backgroundColor: '#E3F2FD',
    textColor: '#0D47A1',
    icon: 'ğŸ’™'
  },
  {
    name: 'å†¥æƒ³ç´«',
    primaryColor: '#9C27B0',
    secondaryColor: '#BA68C8',
    backgroundColor: '#F3E5F5',
    textColor: '#4A148C',
    icon: 'ğŸ”®'
  },
  {
    name: 'é˜…è¯»é’',
    primaryColor: '#00BCD4',
    secondaryColor: '#4DD0E1',
    backgroundColor: '#E0F7FA',
    textColor: '#006064',
    icon: 'ğŸ“˜'
  }
];

/**
 * ä¸»é¢˜ç®¡ç†å™¨å•ä¾‹
 */
export class ThemeManager {
  private static instance: ThemeManager;
  private currentTheme: ThemeConfig = THEMES[0];

  private constructor() {}

  static getInstance(): ThemeManager {
    if (!ThemeManager.instance) {
      ThemeManager.instance = new ThemeManager();
    }
    return ThemeManager.instance;
  }

  /**
   * è·å–å½“å‰ä¸»é¢˜
   */
  getCurrentTheme(): ThemeConfig {
    return this.currentTheme;
  }

  /**
   * è®¾ç½®ä¸»é¢˜
   */
  setTheme(index: number) {
    if (index >= 0 && index < THEMES.length) {
      this.currentTheme = THEMES[index];
      AppStorage.setOrCreate('current_theme', index);
      
      // è§¦å‘å…¨å±€åˆ·æ–°é€šçŸ¥
      const current = AppStorage.get<number>('theme_updated') || 0;
      AppStorage.setOrCreate('theme_updated', current + 1);
    }
  }

  /**
   * ä»æŒä¹…åŒ–å­˜å‚¨åŠ è½½ä¸»é¢˜
   */
  loadTheme() {
    const themeIndex = AppStorage.get<number>('current_theme');
    if (themeIndex !== undefined && themeIndex >= 0 && themeIndex < THEMES.length) {
      this.currentTheme = THEMES[themeIndex];
    }
  }

  /**
   * è·å–æ‰€æœ‰ä¸»é¢˜
   */
  getAllThemes(): ThemeConfig[] {
    return THEMES;
  }
}
