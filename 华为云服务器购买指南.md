# åä¸ºäº‘æœåŠ¡å™¨è´­ä¹°æŒ‡å—(å¤‡æ¡ˆä¸“ç”¨)

> **ç›®çš„**: è´­ä¹°æœ€ä½é…ç½®æœåŠ¡å™¨ç”¨äºAPPå¤‡æ¡ˆ  
> **é¢„ç®—**: çº¦40-60å…ƒ/æœˆ  
> **æ—¥æœŸ**: 2025-12-09

---

## ğŸ¯ è´­ä¹°ç­–ç•¥

### å¤‡æ¡ˆä¸“ç”¨æœåŠ¡å™¨è¦æ±‚
- âœ… ä½äº**ä¸­å›½å¤§é™†**åœ°åŒº
- âœ… è´­ä¹°æ—¶é•¿ â‰¥ **3ä¸ªæœˆ**(å¤‡æ¡ˆè¦æ±‚)
- âœ… æœ€ä½é…ç½®å³å¯(1æ ¸1G)
- âœ… å¸¦å®½1Mbpsè¶³å¤Ÿ

### å¤‡æ¡ˆåç”¨é€”(å¯é€‰)
- ğŸ”„ å°† AWS Lambda è¿ç§»åˆ°å›½å†…
- ğŸ“¦ éƒ¨ç½²èŠ±ç²‰æ•°æ®ç¼“å­˜æœåŠ¡
- ğŸŒ æ­å»ºè‡ªå·±çš„APIä»£ç†
- ğŸ’¾ æ•°æ®åº“æœåŠ¡

---

## ğŸ“¦ æ¨èé…ç½®

### é…ç½®æ–¹æ¡ˆ: åä¸ºäº‘ ECS(å¼¹æ€§äº‘æœåŠ¡å™¨)

| é¡¹ç›® | é…ç½® | è¯´æ˜ |
|------|------|------|
| **CPU** | 1æ ¸ | æœ€ä½é…ç½® |
| **å†…å­˜** | 1GB | å¤Ÿç”¨ |
| **ç³»ç»Ÿç›˜** | 40GB(é«˜IO) | é»˜è®¤å³å¯ |
| **å¸¦å®½** | 1Mbps | æŒ‰ä½¿ç”¨æµé‡è®¡è´¹æ›´ä¾¿å®œ |
| **åœ°åŸŸ** | åå—-å¹¿å· | ç¦»ä½ æœ€è¿‘ |
| **ç³»ç»Ÿé•œåƒ** | CentOS 7.9 æˆ– Ubuntu 20.04 | æ¨èUbuntu |
| **è´­ä¹°æ—¶é•¿** | 3ä¸ªæœˆ | å¤‡æ¡ˆæœ€ä½è¦æ±‚ |

**é¢„è®¡è´¹ç”¨**: çº¦ 40-50 å…ƒ/æœˆ Ã— 3 = 120-150å…ƒ

---

## ğŸ›’ è´­ä¹°æ­¥éª¤

### 1. è¿›å…¥åä¸ºäº‘å®˜ç½‘
https://www.huaweicloud.com/

### 2. ç™»å½•è´¦å·
- ä½¿ç”¨å¤‡æ¡ˆæ—¶çš„åä¸ºäº‘è´¦å·ç™»å½•

### 3. è¿›å…¥ECSè´­ä¹°é¡µé¢
è·¯å¾„: äº§å“ â†’ è®¡ç®— â†’ å¼¹æ€§äº‘æœåŠ¡å™¨ ECS â†’ ç«‹å³è´­ä¹°

æˆ–ç›´æ¥è®¿é—®: https://www.huaweicloud.com/product/ecs.html

### 4. é€‰æ‹©é…ç½®

#### åŸºç¡€é…ç½®
```
è®¡è´¹æ¨¡å¼: åŒ…å¹´/åŒ…æœˆ(å¿…é¡»é€‰è¿™ä¸ªæ‰èƒ½å¤‡æ¡ˆ)
åŒºåŸŸ: åå—-å¹¿å·(æˆ–ç¦»ä½ æœ€è¿‘çš„å¤§é™†åœ°åŒº)
å¯ç”¨åŒº: éšæœºåˆ†é…
```

#### è§„æ ¼
```
é€šç”¨è®¡ç®—å‹ â†’ s6.small.1
  - 1vCPUs
  - 1GBå†…å­˜
  - æœ€å¤§å¸¦å®½: 1Mbps
```

#### é•œåƒ
```
å…¬å…±é•œåƒ â†’ Ubuntu â†’ 20.04 server 64bit
```

#### ç³»ç»Ÿç›˜
```
é«˜IO â†’ 40GB (é»˜è®¤å³å¯)
```

#### ç½‘ç»œé…ç½®
```
è™šæ‹Ÿç§æœ‰äº‘: è‡ªåŠ¨åˆ›å»º
å­ç½‘: è‡ªåŠ¨åˆ›å»º
å®‰å…¨ç»„: è‡ªåŠ¨åˆ›å»º(åç»­å¯ä»¥é…ç½®)
å¼¹æ€§å…¬ç½‘IP: å¿…é€‰
  - è®¡è´¹æ¨¡å¼: æŒ‰æµé‡è®¡è´¹(æ¯”æŒ‰å¸¦å®½ä¾¿å®œ)
  - å¸¦å®½: 1Mbps
```

#### é«˜çº§é…ç½®(å¯é€‰)
```
äº‘æœåŠ¡å™¨åç§°: PollenForecast-Server
ç™»å½•å‡­è¯: å¯†ç (è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç )
```

#### è´­ä¹°æ—¶é•¿
```
â˜‘ 3ä¸ªæœˆ (å¤‡æ¡ˆæœ€ä½è¦æ±‚)
```

### 5. ç¡®è®¤è®¢å•
- æ£€æŸ¥é…ç½®å’Œä»·æ ¼
- é˜…è¯»å¹¶åŒæ„æœåŠ¡åè®®
- ç‚¹å‡»"ç«‹å³è´­ä¹°"

### 6. æ”¯ä»˜
- é€‰æ‹©æ”¯ä»˜æ–¹å¼(å¾®ä¿¡/æ”¯ä»˜å®)
- å®Œæˆæ”¯ä»˜

### 7. ç­‰å¾…åˆ›å»º
- æœåŠ¡å™¨åˆ›å»ºéœ€è¦3-5åˆ†é’Ÿ
- åˆ›å»ºå®Œæˆåä¼šæ”¶åˆ°çŸ­ä¿¡/é‚®ä»¶é€šçŸ¥

---

## âœ… è´­ä¹°å®Œæˆåæ“ä½œ

### 1. æŸ¥çœ‹æœåŠ¡å™¨ä¿¡æ¯
è¿›å…¥æ§åˆ¶å°: æœåŠ¡åˆ—è¡¨ â†’ è®¡ç®— â†’ å¼¹æ€§äº‘æœåŠ¡å™¨

è®°å½•ä»¥ä¸‹ä¿¡æ¯:
```
æœåŠ¡å™¨åç§°: PollenForecast-Server
å…¬ç½‘IP: xxx.xxx.xxx.xxx
å®ä¾‹ID: xxxxxxxx
```

### 2. è¿”å›å¤‡æ¡ˆé¡µé¢
- åˆ·æ–°å¤‡æ¡ˆé¡µé¢
- ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹åˆ°æ–°è´­ä¹°çš„ECS
- "äº‘æœåŠ¡å¯ç”¨æ€§"è­¦å‘Šæ¶ˆå¤±
- ç‚¹å‡»"ä¸‹ä¸€æ­¥"ç»§ç»­å¤‡æ¡ˆ

### 3. é€‰æ‹©äº‘æœåŠ¡å™¨
- åœ¨èµ„æºç±»å‹ä¸­é€‰æ‹©ä½ åˆšè´­ä¹°çš„ECS
- ç»§ç»­å¡«å†™å¤‡æ¡ˆä¿¡æ¯

---

## ğŸ”§ æœåŠ¡å™¨åˆå§‹é…ç½®(å¤‡æ¡ˆåå¯åš)

### 1. ç™»å½•æœåŠ¡å™¨
```bash
# Windowsä½¿ç”¨PowerShell
ssh root@ä½ çš„æœåŠ¡å™¨IP
# è¾“å…¥è´­ä¹°æ—¶è®¾ç½®çš„å¯†ç 
```

### 2. æ›´æ–°ç³»ç»Ÿ
```bash
sudo apt update
sudo apt upgrade -y
```

### 3. å®‰è£…Node.js(å¦‚æœè¦éƒ¨ç½²API)
```bash
# å®‰è£…nvm
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
source ~/.bashrc

# å®‰è£…Node.js 20
nvm install 20
nvm use 20
```

### 4. é…ç½®é˜²ç«å¢™
```bash
# å…è®¸HTTPå’ŒHTTPS
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw allow 22/tcp
sudo ufw enable
```

### 5. (å¯é€‰)éƒ¨ç½²èŠ±ç²‰APIä»£ç†
å°† AWS Lambda çš„åŠŸèƒ½è¿ç§»åˆ°è¿™å°æœåŠ¡å™¨:

```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
mkdir /home/pollen-api
cd /home/pollen-api

# åˆå§‹åŒ–Node.jsé¡¹ç›®
npm init -y
npm install express axios cors

# åˆ›å»ºserver.js
nano server.js
```

**server.js å†…å®¹**:
```javascript
const express = require('express');
const axios = require('axios');
const cors = require('cors');

const app = express();
app.use(cors());

const GOOGLE_API_KEY = 'AIzaSyCqWhX-k3H5kONC2WV3DtcIs8PtkwdmMH8';

app.get('/pollen', async (req, res) => {
  const { lat, lng, days = 5 } = req.query;
  
  try {
    const response = await axios.get(
      `https://pollen.googleapis.com/v1/forecast:lookup`,
      {
        params: { key: GOOGLE_API_KEY, location: `${lat},${lng}`, days },
        headers: { 'X-Goog-FieldMask': 'dailyInfo' }
      }
    );
    res.json(response.data);
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

app.listen(3000, () => {
  console.log('Pollen API running on port 3000');
});
```

**å¯åŠ¨æœåŠ¡**:
```bash
# å®‰è£…PM2(è¿›ç¨‹ç®¡ç†)
npm install -g pm2

# å¯åŠ¨æœåŠ¡
pm2 start server.js --name pollen-api
pm2 save
pm2 startup
```

### 6. é…ç½®Nginxåå‘ä»£ç†(å¯é€‰)
```bash
sudo apt install nginx -y

# ç¼–è¾‘Nginxé…ç½®
sudo nano /etc/nginx/sites-available/pollen-api
```

**é…ç½®å†…å®¹**:
```nginx
server {
    listen 80;
    server_name ä½ çš„æœåŠ¡å™¨IP;

    location /api/ {
        proxy_pass http://localhost:3000/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

**å¯ç”¨é…ç½®**:
```bash
sudo ln -s /etc/nginx/sites-available/pollen-api /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

---

## ğŸ’° æˆæœ¬ä¼˜åŒ–

### å¤‡æ¡ˆæˆåŠŸå
å¦‚æœåªæ˜¯ä¸ºäº†å¤‡æ¡ˆ,ä¸æƒ³ç»§ç»­ä½¿ç”¨æœåŠ¡å™¨:

1. **ä¿ç•™3ä¸ªæœˆ** - å¤‡æ¡ˆè¦æ±‚æœ€ä½æŒæœ‰æœŸ
2. **3ä¸ªæœˆå** - å¯ä»¥é€‰æ‹©:
   - ç»­è´¹ç»§ç»­ä½¿ç”¨
   - åˆ°æœŸä¸ç»­è´¹(å¤‡æ¡ˆå·ä¿ç•™)
   - è½¬ä¸ºæŒ‰é‡è®¡è´¹(æ›´ä¾¿å®œ)

### é•¿æœŸä½¿ç”¨
å¦‚æœè¦é•¿æœŸä½¿ç”¨:
- è´­ä¹°1å¹´äº«å—æŠ˜æ‰£(çº¦35å…ƒ/æœˆ)
- è´­ä¹°3å¹´æ›´ä¼˜æƒ (çº¦30å…ƒ/æœˆ)

---

## ğŸ“ è´­ä¹°é‡åˆ°é—®é¢˜

### å¸¸è§é—®é¢˜

**Q: æ‰¾ä¸åˆ°1æ ¸1Gé…ç½®?**
A: é€‰æ‹©"é€šç”¨è®¡ç®—å‹ s6" ç³»åˆ—,æˆ–è€…æœç´¢"å…¥é—¨çº§"

**Q: æç¤ºéœ€è¦å®åè®¤è¯?**
A: å®Œæˆåä¸ºäº‘è´¦å·å®åè®¤è¯(ä¸Šä¼ èº«ä»½è¯)

**Q: å¤‡æ¡ˆæ—¶æ‰¾ä¸åˆ°æœåŠ¡å™¨?**
A: 
1. ç¡®è®¤æœåŠ¡å™¨åœ¨ä¸­å›½å¤§é™†åœ°åŒº
2. ç¡®è®¤è´­ä¹°æ—¶é•¿â‰¥3ä¸ªæœˆ
3. åˆ·æ–°å¤‡æ¡ˆé¡µé¢

**Q: è´­ä¹°åå¤šä¹…å¯ä»¥ç”¨äºå¤‡æ¡ˆ?**
A: æœåŠ¡å™¨åˆ›å»ºå®Œæˆ(çº¦5åˆ†é’Ÿ)åç«‹å³å¯ç”¨

---

## âœ… è´­ä¹°æ£€æŸ¥æ¸…å•

- [ ] ç™»å½•åä¸ºäº‘è´¦å·
- [ ] è´¦å·å·²å®åè®¤è¯
- [ ] é€‰æ‹©ä¸­å›½å¤§é™†åœ°åŒº(åå—-å¹¿å·)
- [ ] é€‰æ‹©1æ ¸1Gé…ç½®
- [ ] è´­ä¹°æ—¶é•¿â‰¥3ä¸ªæœˆ
- [ ] é€‰æ‹©å¼¹æ€§å…¬ç½‘IP
- [ ] è®¾ç½®å®‰å…¨çš„ç™»å½•å¯†ç 
- [ ] ç¡®è®¤ä»·æ ¼åœ¨é¢„ç®—å†…(çº¦120-150å…ƒ)
- [ ] å®Œæˆæ”¯ä»˜
- [ ] è®°å½•æœåŠ¡å™¨IPå’Œå®ä¾‹ID

---

**è´­ä¹°å®Œæˆå,å›åˆ°å¤‡æ¡ˆé¡µé¢ç»§ç»­æ“ä½œ!**
