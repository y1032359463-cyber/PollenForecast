/**
 * å¦‚å•è®°å½•æ•°æ®æ¨¡å‹
 */

/**
 * å¦‚å•ç±»å‹
 */
export enum RecordType {
  URINE = 'urine',      // å°ä¾¿
  STOOL = 'stool',      // å¤§ä¾¿
  BOTH = 'both'         // ä¸¤è€…éƒ½æœ‰
}

/**
 * èˆ’é€‚åº¦è¯„ä»·
 */
export enum ComfortLevel {
  VERY_COMFORTABLE = 5,   // éå¸¸èˆ’é€‚ ğŸ˜Š
  COMFORTABLE = 4,        // èˆ’é€‚ ğŸ™‚
  NORMAL = 3,            // ä¸€èˆ¬ ğŸ˜
  UNCOMFORTABLE = 2,      // ä¸é€‚ ğŸ˜Ÿ
  VERY_UNCOMFORTABLE = 1  // éå¸¸ä¸é€‚ ğŸ˜£
}

/**
 * å¦‚å•è®°å½•
 */
export interface ToiletRecord {
  id: string;                    // è®°å½•ID
  userId?: string;               // ç”¨æˆ·IDï¼ˆå¯é€‰ï¼Œæœªç™»å½•ç”¨æˆ·æœ¬åœ°å­˜å‚¨ï¼‰
  
  // æ—¶é—´ä¿¡æ¯
  recordTime: number;            // è®°å½•æ—¶é—´ï¼ˆæ—¶é—´æˆ³ï¼‰
  duration: number;              // ç”¨æ—¶ï¼ˆç§’ï¼‰
  
  // ä½ç½®ä¿¡æ¯
  toiletId?: string;             // å•æ‰€IDï¼ˆå¦‚æœæ˜¯å·²çŸ¥å•æ‰€ï¼‰
  toiletName?: string;           // å•æ‰€åç§°
  latitude: number;              // çº¬åº¦
  longitude: number;             // ç»åº¦
  address: string;               // åœ°å€
  
  // è®°å½•è¯¦æƒ…
  type: RecordType;              // å¦‚å•ç±»å‹
  comfortLevel: ComfortLevel;    // èˆ’é€‚åº¦
  rating?: number;               // å¯¹å•æ‰€çš„è¯„åˆ†ï¼ˆ1-5ï¼‰
  
  // å¤‡æ³¨
  note?: string;                 // ç”¨æˆ·å¤‡æ³¨
  
  // å¥åº·ç›¸å…³ï¼ˆå¯é€‰ï¼‰
  hasIssue?: boolean;            // æ˜¯å¦æœ‰å¼‚å¸¸
  issueDescription?: string;     // å¼‚å¸¸æè¿°
  
  // éšç§
  isPrivate: boolean;            // æ˜¯å¦ç§å¯†ï¼ˆä¸å‚ä¸ç»Ÿè®¡åˆ†äº«ï¼‰
  
  // æ—¶é—´æˆ³
  createdAt: number;             // åˆ›å»ºæ—¶é—´
  syncedAt?: number;             // åŒæ­¥åˆ°äº‘ç«¯æ—¶é—´
}

/**
 * ç»Ÿè®¡æ•°æ®
 */
export interface RecordStatistics {
  // æ—¶é—´èŒƒå›´
  startDate: number;
  endDate: number;
  
  // åŸºç¡€ç»Ÿè®¡
  totalCount: number;            // æ€»æ¬¡æ•°
  averageDuration: number;       // å¹³å‡æ—¶é•¿ï¼ˆç§’ï¼‰
  
  // èˆ’é€‚åº¦ç»Ÿè®¡
  comfortDistribution: ComfortDistribution;
  
  // ç±»å‹ç»Ÿè®¡
  typeDistribution: TypeDistribution;
  
  // æ—¶æ®µç»Ÿè®¡
  hourDistribution: number[];    // 24å°æ—¶åˆ†å¸ƒï¼ˆ0-23ç‚¹ï¼‰
  
  // åœ°ç‚¹ç»Ÿè®¡
  topLocations: TopLocation[];
  
  // è¶‹åŠ¿
  dailyCounts: DailyCount[];
}

/**
 * èˆ’é€‚åº¦åˆ†å¸ƒ
 */
export interface ComfortDistribution {
  veryComfortable: number;
  comfortable: number;
  normal: number;
  uncomfortable: number;
  veryUncomfortable: number;
}

/**
 * ç±»å‹åˆ†å¸ƒ
 */
export interface TypeDistribution {
  urine: number;
  stool: number;
  both: number;
}

/**
 * é«˜é¢‘åœ°ç‚¹
 */
export interface TopLocation {
  toiletName: string;
  count: number;
}

/**
 * æ¯æ—¥æ¬¡æ•°
 */
export interface DailyCount {
  date: string;
  count: number;
}

/**
 * åˆ›å»ºé»˜è®¤è®°å½•
 */
export function createDefaultRecord(): ToiletRecord {
  return {
    id: `record_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
    recordTime: Date.now(),
    duration: 0,
    latitude: 0,
    longitude: 0,
    address: '',
    type: RecordType.URINE,
    comfortLevel: ComfortLevel.NORMAL,
    isPrivate: false,
    createdAt: Date.now()
  };
}
