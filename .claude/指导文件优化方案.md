# 指导文件优化方案

> **创建日期**: 2026-01-08  
> **问题**: AI 无法准确读取和执行指导文件，可能因内容过多、结构臃肿

---

## 📊 当前文件大小分析

| 文件 | 行数 | 大小 | 问题 |
|------|------|------|------|
| `.claude/CLAUDE.md` | 893行 | 53.32KB | ⚠️ 过大，包含大量历史日志 |
| `知识库.md` | 687行 | 30.49KB | ⚠️ 主索引+完整内容混合 |
| `知识库_中转站.md` | 756行 | 38.11KB | ⚠️ 待验证内容积累过多 |
| `当前问题.md` | 999行 | 38.9KB | ⚠️ 问题记录未及时清理 |

**总计**: 3335行，160.82KB

---

## 🔍 问题诊断

### 1. CLAUDE.md 问题
- **历史日志过多**: 从 2025-12-05 到 2026-01-08 的所有开发日志都在一个文件
- **结构混乱**: 当前状态、历史会话、开发日志、技术沉淀混在一起
- **重复内容**: 同一功能在不同章节重复描述

### 2. 知识库.md 问题
- **主索引+内容混合**: 既有索引导航，又有完整技术方案
- **紧急救援区域过大**: 22个快速跳转链接，但实际常用只有5-6个
- **完整版知识库**: 5353行的完整版文件存在但未充分利用

### 3. 知识库_中转站.md 问题
- **待验证内容积累**: 756行待验证方案，部分已过时
- **未及时清理**: 已验证方案未及时迁移到知识库

### 4. 当前问题.md 问题
- **内容未清理**: 999行，包含大量已解决的问题和专家回复
- **结构混乱**: 问题描述、专家回复、验证结果混在一起

---

## ✅ 优化方案

### 方案1: CLAUDE.md 精简（推荐）

**目标**: 将 893行 → 300行以内

**策略**:
1. **保留核心内容**:
   - 当前状态概要（50行）
   - 关键文件位置（20行）
   - 最近3次会话完成内容（100行）
   - 当前待办事项（30行）
   - 项目基本信息（50行）

2. **移除/迁移内容**:
   - 历史开发日志 → 迁移到 `开发日志.md`（独立文件）
   - 技术沉淀 → 迁移到知识库
   - 服务器架构详情 → 迁移到 `server/README.md`
   - 代码备份记录 → 只保留最近5条

3. **文件结构**:
```
.claude/
├── CLAUDE.md（精简版，300行）
├── 开发日志.md（历史日志，按日期归档）
└── 问题记录.md（构建修复记录）
```

### 方案2: 知识库.md 优化

**目标**: 将 687行 → 200行以内（纯索引）

**策略**:
1. **主索引文件只保留导航**:
   - 紧急救援（精简到10个最常用）
   - 分类导航（指向子文件）
   - 快速参考卡片

2. **详细内容移到分类文件**:
   - 已分类到 `知识库/ArkTS语法.md` 等
   - 主索引不再重复内容

### 方案3: 知识库_中转站.md 清理

**目标**: 将 756行 → 200行以内

**策略**:
1. **清理已过时内容**:
   - 2025-12-29 之前的待验证方案（已超过验证期限）
   - 已明确失败的方案（移到避坑指南）

2. **保留活跃内容**:
   - 最近1个月内的待验证方案
   - 有明确验证计划的方案

### 方案4: 当前问题.md 定期清理

**目标**: 每次新问题时清空，只保留当前问题

**策略**:
1. **问题解决后立即清空**
2. **已验证方案立即迁移到知识库**
3. **文件大小控制在 200行以内**

---

## 🎯 实施优先级

### P0（立即执行）
1. ✅ **CLAUDE.md 精简** - 影响最大，AI 每次都会读取
   - 移除历史日志（2025-12-05 之前）
   - 精简当前状态概要
   - 只保留最近3次会话

2. ✅ **当前问题.md 清理** - 999行过大
   - 清空已解决问题
   - 只保留当前活跃问题

### P1（本周完成）
3. **知识库.md 精简** - 687行可优化
   - 移除重复内容
   - 只保留索引导航

4. **知识库_中转站.md 清理** - 756行待清理
   - 清理过时方案
   - 迁移已验证方案

### P2（后续优化）
5. **创建开发日志.md** - 归档历史日志
6. **优化文件结构** - 建立清晰的文档体系

---

## 📋 具体操作建议

### 立即执行（P0）

**1. CLAUDE.md 精简**:
- 删除 "开发日志" 章节（第552行开始）
- 删除 "技术沉淀" 章节（第1300行开始）
- 删除 "服务器部署架构" 详细内容（移到 server/README.md）
- 精简 "代码备份记录"（只保留最近5条）

**2. 当前问题.md 清理**:
- 清空文件内容
- 只保留当前活跃问题（如果有）

**预期效果**:
- CLAUDE.md: 893行 → 300行（↓66%）
- 当前问题.md: 999行 → 50行（↓95%）
- **总计**: 3335行 → 1500行（↓55%）

---

## ⚠️ 注意事项

1. **不要删除已验证内容** - 只移动位置，不删除
2. **保留 Git 历史** - 历史日志移到独立文件，不删除
3. **保持链接有效** - 移动内容后更新所有链接
4. **逐步优化** - 先执行 P0，验证效果后再执行 P1

---

## 📈 预期效果

**优化前**:
- AI 读取文件: 3335行，160KB
- 读取时间: 长，可能遗漏关键信息
- 执行准确性: 低，容易忽略规则

**优化后**:
- AI 读取文件: 1500行，75KB
- 读取时间: 短，能快速定位关键信息
- 执行准确性: 高，规则清晰明确

---

## 🔄 维护规则

1. **CLAUDE.md**: 每次会话后只更新"本次会话完成"，历史日志移到开发日志.md
2. **当前问题.md**: 问题解决后立即清空
3. **知识库_中转站.md**: 每月清理一次，移除超过1个月的待验证方案
4. **知识库.md**: 只追加，不删除，但定期精简索引

