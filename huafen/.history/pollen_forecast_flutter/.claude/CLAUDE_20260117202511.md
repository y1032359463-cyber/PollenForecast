# èŠ±ç²‰æµ“åº¦æ’­æŠ¥ - Flutter è·¨å¹³å°ç‰ˆ (pollen_forecast_flutter)

> **ä½œç”¨èŒƒå›´**: Flutter è·¨å¹³å°é¡¹ç›®ä¸“å±æ–‡æ¡£
> **æœ€åæ›´æ–°**: 2026-01-17 (API æµ‹è¯•å®Œæˆ + åŸå¸‚æ•°æ®å¤åˆ¶)
> **AI ç»´æŠ¤è€…**: Claude

---

## âš ï¸ AI å¿…è¯»è§„åˆ™

**æ–‡æ¡£æ•´ç†æé†’**ï¼šè¯»å–æœ¬æ–‡æ¡£æ—¶ï¼Œå¦‚æœå‘ç°è¡Œæ•° > 400è¡Œï¼Œè¯¢é—®ç”¨æˆ·æ˜¯å¦éœ€è¦æ•´ç†ã€‚

### ğŸš¨ ä¸é¸¿è’™é¡¹ç›®çš„å…³ç³»

æœ¬é¡¹ç›®æ˜¯ **èŠ±ç²‰æµ“åº¦æ’­æŠ¥** çš„ Flutter è·¨å¹³å°ç‰ˆæœ¬ï¼Œç”¨äºè¦†ç›– iOS å’Œ Android ç”¨æˆ·ã€‚

| é¡¹ç›® | è·¯å¾„ | å¹³å° |
|------|------|------|
| é¸¿è’™åŸç”Ÿ | `C:\HarmonyOS_App_Plans\huafen\PollenForecast\` | HarmonyOS |
| Flutter è·¨å¹³å° | `C:\HarmonyOS_App_Plans\huafen\pollen_forecast_flutter\` | iOS + Android |

**å…±äº«èµ„æº**ï¼šä¸¤ä¸ªé¡¹ç›®å…±äº«ç›¸åŒçš„åç«¯ APIã€æ•°æ®æ¨¡å‹è®¾è®¡å’Œ UI è®¾è®¡è§„èŒƒã€‚

---

## ğŸš¨ å½“å‰çŠ¶æ€æ¦‚è¦

### âš ï¸ å½“å‰çŠ¶æ€(2026-01-17 æ›´æ–°)

**åŸå¸‚æœç´¢é¡µé¢å¼€å‘å®Œæˆ** âœ…
- âœ… æœç´¢æ¡† - æ”¯æŒä¸­æ–‡ã€æ‹¼éŸ³ã€æ‹¼éŸ³é¦–å­—æ¯æœç´¢
- âœ… çƒ­é—¨åŸå¸‚åˆ—è¡¨ - 7ä¸ªå¸¸ç”¨åŸå¸‚ï¼ˆåŒ—äº¬ã€ä¸Šæµ·ã€å¹¿å·ç­‰ï¼‰
- âœ… æˆ‘çš„æ”¶è— - æ˜¾ç¤ºç”¨æˆ·æ”¶è—çš„åŸå¸‚ï¼ˆæœ€å¤š4ä¸ªï¼‰
- âœ… æœç´¢ç»“æœåˆ—è¡¨ - å®æ—¶è¿‡æ»¤ï¼ˆæ”¯æŒ3244ä¸ªåŒºåŸŸï¼‰
- âœ… ç‚¹å‡»åŸå¸‚ - è¿”å›é¦–é¡µå¹¶ä¼ é€’åŸå¸‚åç§°ã€åæ ‡ã€adcode
- âœ… æ•°æ®æ¨¡å‹ - CityItemã€DistrictItemã€PinyinMapItem
- âœ… å·¥å…·ç±» - loadPinyinMapã€loadChinaAreaDataã€searchCities
- âœ… å•å…ƒæµ‹è¯• - æµ‹è¯•æœç´¢ã€æ”¶è—ã€æ‹¼éŸ³åŠŸèƒ½

**æ•°æ®æ–‡ä»¶é…ç½®å®Œæˆ** âœ…
- âœ… assets/data/china_area_full.json - å…¨å›½3244ä¸ªåŒºåŸŸæ•°æ®
- âœ… assets/data/pinyin_map.json - æ‹¼éŸ³æ˜ å°„è¡¨
- âœ… pubspec.yaml - å·²æ·»åŠ æ•°æ®æ–‡ä»¶åˆ° assets

**iOS é…ç½®å®Œæˆ** âœ…
- Bundle Identifier: `com.eric.PollenForecast`ï¼ˆä¸é¸¿è’™ç‰ˆä¸€è‡´ï¼‰
- æœ€ä½æ”¯æŒç‰ˆæœ¬: iOS 12.0+
- å¼€å‘ç¯å¢ƒ: Windows + Codemagic CI/CD

**é¦–é¡µ UI å¼€å‘å®Œæˆ** âœ…
- èŠ±ç²‰æŒ‡æ•°åœ†ç¯ç»„ä»¶ï¼ˆCustomPainter ç»˜åˆ¶ï¼‰
- 7å¤©é¢„æŠ¥æ¨ªå‘æ»šåŠ¨å›¾è¡¨
- é˜²æŠ¤æŒ‡å—æ™ºèƒ½åˆ‡æ¢ï¼ˆæ ¹æ®ç­‰çº§ï¼‰
- ä¸‹æ‹‰åˆ·æ–°åŠŸèƒ½
- åŠ è½½çŠ¶æ€å’Œé”™è¯¯å¤„ç†

**é¡¹ç›®åŸºç¡€æ­å»ºå®Œæˆ** âœ…
- Flutter SDK å®‰è£…ä¸éªŒè¯ï¼ˆWindows ç¯å¢ƒï¼‰
- é¡¹ç›®åˆ›å»ºä¸ä¾èµ–é…ç½®
- API é…ç½®å¤ç”¨ï¼ˆèŠ±ç²‰æ•°æ®æœåŠ¡å™¨ã€å¤©æ°”æ•°æ®æœåŠ¡å™¨ï¼‰
- æ•°æ®æ¨¡å‹å®šä¹‰ï¼ˆä¸é¸¿è’™é¡¹ç›®ä¸€è‡´ï¼‰
- åŸºç¡€æœåŠ¡ç±»ï¼ˆå¤šæœåŠ¡å™¨æ•…éšœè½¬ç§»ï¼‰

 ### ğŸ“‹ å¾…å®ŒæˆåŠŸèƒ½

| ä¼˜å…ˆçº§ | åŠŸèƒ½ | è´Ÿè´£äºº | çŠ¶æ€ |
|--------|------|--------|------|
| P0 | GPS å®šä½é›†æˆ | Claude | ğŸ“‹ å¾…å¼€å‘ |
| P1 | åŒºåŸŸé€‰æ‹©é¡µé¢ | GLM-4.7 | ğŸ“‹ å¾…å¼€å‘ |
| P1 | è®¾ç½®é¡µé¢ | GLM-4.7 | ğŸ“‹ å¾…å¼€å‘ |
| P2 | åœ°å›¾é›†æˆï¼ˆGoogle Mapsï¼‰ | Claude | ğŸ“‹ å¾…å¼€å‘ |
| P2 | æ·±è‰²æ¨¡å¼é€‚é… | GLM-4.7 | ğŸ“‹ å¾…å¼€å‘ |

---

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

| å±æ€§ | å€¼ |
|------|-----|
| **åº”ç”¨ID** | com.eric.PollenForecast |
| **ä¸­æ–‡å** | èŠ±ç²‰æµ“åº¦æ’­æŠ¥ |
| **ç‰ˆæœ¬** | 1.1.0+1 |
| **Flutter SDK** | 3.38.7 |
| **Dart SDK** | 3.10.7 |
| **æœ€ä½ iOS** | 12.0 |
| **æœ€ä½ Android** | API 21 (Android 5.0) |
| **çŠ¶æ€** | ğŸ”„ åŸºç¡€æ¡†æ¶å·²å®Œæˆï¼Œå¼€å‘ä¸­ |

### ç›®æ ‡å¹³å°
- ğŸ“± **iOS**: App Store å‘å¸ƒï¼ˆé€šè¿‡ Codemagic CI/CD æ„å»ºï¼‰
- ğŸ¤– **Android**: Google Play å‘å¸ƒ

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
pollen_forecast_flutter/
â”œâ”€â”€ .claude/                    # AI åä½œæ–‡æ¡£
â”‚   â””â”€â”€ CLAUDE.md              # æœ¬æ–‡ä»¶
â”œâ”€â”€ lib/                        # Dart æºç 
â”‚   â”œâ”€â”€ main.dart              # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ api_config.dart    # API é…ç½®ï¼ˆå¤ç”¨é¸¿è’™é¡¹ç›®ï¼‰
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ pollen_models.dart # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ screens/
â”‚   â”‚   â””â”€â”€ home_screen.dart   # é¦–é¡µï¼ˆå·²å®Œæˆï¼‰
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ pollen_service.dart # èŠ±ç²‰æ•°æ®æœåŠ¡
â”‚   â”œâ”€â”€ widgets/               # å¯å¤ç”¨ç»„ä»¶ï¼ˆå¾…å¼€å‘ï¼‰
â”‚   â””â”€â”€ utils/                 # å·¥å…·ç±»ï¼ˆå¾…å¼€å‘ï¼‰
â”œâ”€â”€ assets/                     # é™æ€èµ„æº
â”‚   â”œâ”€â”€ images/                # å›¾ç‰‡èµ„æº
â”‚   â””â”€â”€ data/                  # æ•°æ®æ–‡ä»¶
â”œâ”€â”€ ios/                        # iOS å¹³å°é…ç½®
â”‚   â””â”€â”€ Runner.xcodeproj/
â”‚       â””â”€â”€ project.pbxproj    # Xcode é¡¹ç›®é…ç½®
â”œâ”€â”€ android/                    # Android å¹³å°é…ç½®
â”œâ”€â”€ test/                       # å•å…ƒæµ‹è¯•
â”œâ”€â”€ pubspec.yaml               # ä¾èµ–é…ç½®
â””â”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
```

---

## ğŸ”§ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒä¾èµ–

| ä¾èµ– | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| flutter | SDK | æ¡†æ¶æ ¸å¿ƒ |
| dio | ^5.4.0 | ç½‘ç»œè¯·æ±‚ |
| provider | ^6.1.1 | çŠ¶æ€ç®¡ç† |
| shared_preferences | ^2.2.0 | æœ¬åœ°å­˜å‚¨ |
| geolocator | ^11.0.0 | GPS å®šä½ |
| json_annotation | ^4.8.1 | JSON åºåˆ—åŒ– |

### å¼€å‘ä¾èµ–

| ä¾èµ– | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| flutter_lints | ^6.0.0 | ä»£ç æ£€æŸ¥ |
| build_runner | ^2.4.7 | ä»£ç ç”Ÿæˆ |
| json_serializable | ^6.7.1 | JSON ä»£ç ç”Ÿæˆ |

---

## ğŸŒ API é…ç½®

### èŠ±ç²‰æ•°æ®æœåŠ¡å™¨ï¼ˆå¤šæœåŠ¡å™¨æ•…éšœè½¬ç§»ï¼‰

| ä¼˜å…ˆçº§ | æœåŠ¡å™¨ | URL |
|--------|--------|-----|
| 1 | AWS Lambda ä¸œäº¬ | `https://g7d8o7pf5b.execute-api.ap-northeast-1.amazonaws.com/default/pollen-api` |
| 2 | AWS Lambda æ–°åŠ å¡ | `https://8de0lncs7f.execute-api.ap-southeast-1.amazonaws.com/default/pollen-api-singapore` |
| 3 | é˜¿é‡Œäº‘æ–°åŠ å¡ | `http://47.84.1.164:5000/pollen-api` |

### å¤©æ°”æ•°æ®æœåŠ¡å™¨

- **åŸºç¡€ URL**: `http://106.12.143.105:3000`
- **ç«¯ç‚¹**:
  - `/weather/now` - å®æ—¶å¤©æ°”
  - `/weather/7d` - 7å¤©é¢„æŠ¥
  - `/minshu/pollen/day` - Minshu èŠ±ç²‰æ•°æ®

---

## ğŸ“ˆ å¼€å‘è¿›åº¦

### å·²å®Œæˆ âœ…

- [x] **API è¿æ¥æµ‹è¯•** (2026-01-17)
  - âœ… æµ‹è¯•ä¸‰ä¸ªèŠ±ç²‰æœåŠ¡å™¨å¯ç”¨æ€§
  - âœ… ç¡®è®¤å¤šæœåŠ¡å™¨æ•…éšœè½¬ç§»æœºåˆ¶æ­£å¸¸
  - âœ… AWS Lambda æ–°åŠ å¡é€Ÿåº¦æœ€å¿«ï¼ˆ1.7ç§’ï¼‰
  - âœ… éªŒè¯å†¬å­£æ•°æ®è¿”å›ï¼ˆindexInfo ä¸º nullï¼Œç¬¦åˆé¢„æœŸï¼‰

- [x] **åŸå¸‚æ•°æ®å¤åˆ¶** (2026-01-17)
  - âœ… å¤åˆ¶ `china_area_full.json` åˆ° `assets/data/`
  - âœ… å¤åˆ¶ `pinyin_map.json` åˆ° `assets/data/`
  - âœ… åˆ›å»º `assets/data/` ç›®å½•ç»“æ„
  - âœ… å…±äº«é¸¿è’™é¡¹ç›®çš„3244ä¸ªåŒºåŸŸæ•°æ®

- [x] **iOS é¡¹ç›®é…ç½®** (2026-01-17)
  - âœ… Bundle Identifier: `com.eric.PollenForecast`
  - âœ… æœ€ä½æ”¯æŒç‰ˆæœ¬: iOS 12.0
  - âœ… Debug/Release/Profile ä¸‰ä¸ªé…ç½®å‡å·²æ›´æ–°

- [x] **é¦–é¡µ UI å¼€å‘** (2026-01-17)
  - âœ… èŠ±ç²‰æŒ‡æ•°åœ†ç¯ç»„ä»¶ï¼ˆCustomPainterï¼‰
  - âœ… 7å¤©é¢„æŠ¥æ¨ªå‘æ»šåŠ¨åˆ—è¡¨
  - âœ… é˜²æŠ¤å»ºè®®å¡ç‰‡
  - âœ… ä¸‹æ‹‰åˆ·æ–°ï¼ˆRefreshIndicatorï¼‰
  - âœ… åŠ è½½/é”™è¯¯çŠ¶æ€å¤„ç†

- [x] **é¡¹ç›®åŸºç¡€æ­å»º** (2026-01-17)
  - âœ… Flutter é¡¹ç›®åˆ›å»º
  - âœ… ä¾èµ–é…ç½®ï¼ˆdioã€providerã€geolocator ç­‰ï¼‰
  - âœ… API é…ç½®å¤ç”¨
  - âœ… æ•°æ®æ¨¡å‹å®šä¹‰
  - âœ… æœåŠ¡å±‚å®ç°ï¼ˆå¤šæœåŠ¡å™¨æ•…éšœè½¬ç§»ï¼‰

### è¿›è¡Œä¸­ ğŸ”„

- æš‚æ— 

### å¾…å¼€å‘ ğŸ“‹

- [ ] GPS å®šä½åŠŸèƒ½
- [ ] åŸå¸‚æœç´¢å’Œæ”¶è—
- [ ] åŒºåŸŸé€‰æ‹©é¡µé¢
- [ ] è®¾ç½®é¡µé¢
- [ ] åœ°å›¾é›†æˆ
- [ ] æ·±è‰²æ¨¡å¼
- [ ] å¤šè¯­è¨€æ”¯æŒ

---

## ğŸ¨ UI è®¾è®¡è§„èŒƒ

### èŠ±ç²‰æµ“åº¦ç­‰çº§ï¼ˆä¸é¸¿è’™é¡¹ç›®ä¸€è‡´ï¼‰

| ç­‰çº§ | æ•°å€¼èŒƒå›´ | é¢œè‰²ä»£ç  | æ ‡ç­¾ |
|------|----------|----------|------|
| 1çº§ | 0-30 | `0xFF4CAF50` | ä½ |
| 2çº§ | 31-60 | `0xFFFFC107` | ä¸­ |
| 3çº§ | 61-90 | `0xFFFF9800` | é«˜ |
| 4çº§ | 91-120 | `0xFFF44336` | å¾ˆé«˜ |
| 5çº§ | >120 | `0xFF9C27B0` | æé«˜ |

### ä¸»é¢˜è‰²æ¿

| ç”¨é€” | é¢œè‰² |
|------|------|
| ä¸»è‰²è°ƒ | `#4CAF50` (å¥åº·ç»¿) |
| ä½é£é™© | `#E8F5E9` |
| ä¸­é£é™© | `#FFF3E0` |
| é«˜é£é™© | `#FFEBEE` |
| æé«˜é£é™© | `#F44336` |

---

## ğŸš€ å¼€å‘æŒ‡å—

### æœ¬åœ°è¿è¡Œ

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd C:\HarmonyOS_App_Plans\huafen\pollen_forecast_flutter

# è·å–ä¾èµ–
flutter pub get

# è¿è¡Œ Web ç‰ˆï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰
flutter run -d chrome

# è¿è¡Œ Android æ¨¡æ‹Ÿå™¨
flutter run -d android

# æ„å»º APK
flutter build apk --release
```

### iOS æ„å»ºï¼ˆCodemagic CI/CDï¼‰

ç”±äº Windows ç¯å¢ƒæ— æ³•ç›´æ¥æ„å»º iOSï¼Œä½¿ç”¨ Codemagic äº‘æ„å»ºï¼š

1. æ¨é€ä»£ç åˆ° GitHub
2. åœ¨ Codemagic é…ç½®æ„å»ºæµç¨‹
3. è‡ªåŠ¨æ„å»ºå¹¶ç­¾å IPA
4. ä¸‹è½½æˆ–ç›´æ¥ä¸Šä¼ åˆ° App Store Connect

### ä»£ç ç”Ÿæˆ

```bash
# ç”Ÿæˆ JSON åºåˆ—åŒ–ä»£ç 
flutter pub run build_runner build --delete-conflicting-outputs
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### Windows å¼€å‘é™åˆ¶

- âŒ æ— æ³•ç›´æ¥è¿è¡Œ iOS æ¨¡æ‹Ÿå™¨
- âŒ æ— æ³•ç›´æ¥æ„å»º IPA
- âœ… å¯ä»¥ä¿®æ”¹ iOS é…ç½®æ–‡ä»¶ï¼ˆå¦‚ `project.pbxproj`ï¼‰
- âœ… å¯ä»¥é€šè¿‡ Web ç‰ˆæµ‹è¯• UI

### API å…¼å®¹æ€§

- èŠ±ç²‰ API è¿”å›çš„æ•°æ®æ ¼å¼ä¸é¸¿è’™ç‰ˆä¸€è‡´
- å†¬å­£ï¼ˆ12æœˆ-2æœˆï¼‰èŠ±ç²‰æ•°æ®å¯èƒ½ä¸ºç©ºæˆ–ä½å€¼
- å»ºè®®ä½¿ç”¨å¹¿å·åæ ‡ï¼ˆ23.12, 113.26ï¼‰æµ‹è¯•

---

## ğŸ”— ç›¸å…³èµ„æº

### é¡¹ç›®æ–‡æ¡£

- é¸¿è’™é¡¹ç›®æ–‡æ¡£: `../PollenForecast/.claude/CLAUDE.md`
- çŸ¥è¯†åº“: `C:\HarmonyOS_App_Plans\.claude\çŸ¥è¯†åº“.md`

### å¤–éƒ¨èµ„æº

- [Flutter å®˜æ–¹æ–‡æ¡£](https://flutter.dev/docs)
- [Dart è¯­è¨€æŒ‡å—](https://dart.dev/guides)
- [Codemagic CI/CD](https://codemagic.io/)

---

**è®°ä½**: ä¸é¸¿è’™é¡¹ç›®ä¿æŒ API å’Œè®¾è®¡è§„èŒƒçš„ä¸€è‡´æ€§ï¼
